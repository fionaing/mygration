{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h1 class="mb-4">
    {% if editing %}Edit Plan{% else %}Create Plan{% endif %}
  </h1>

  <form method="post" enctype="multipart/form-data" novalidate>
    {% csrf_token %}
    <div class="row g-4">

      {# ---------- left column: inputs ---------- #}
      <div class="col-md-6">
        {{ form.non_field_errors }}

        <div class="mb-3">
          <label for="{{ form.name.id_for_label }}" class="form-label">Name</label>
          {{ form.name }}
          {{ form.name.errors }}
        </div>

        <div class="mb-3">
          <label for="{{ form.location.id_for_label }}" class="form-label">Location</label>
          {{ form.location }}
          {{ form.location.errors }}
        </div>

        <div class="mb-3">
          <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
          {{ form.description }}
          {{ form.description.errors }}
        </div>

        <div class="mb-3">
          <label for="{{ form.public.id_for_label }}" class="form-label">Public </label>
          <input type="checkbox" name="public" id="public" value="{{ form.public }}" >
          {{ form.public.errors }}
        </div>

        {# clean “Choose new image” input (no redundant current-url line) #}
        <div class="mb-3">
          <label for="id_image" class="form-label">Choose New Image (Optional)</label>
          <input type="file" name="image" id="id_image" class="form-control">
          {% if form.image.errors %}{{ form.image.errors }}{% endif %}
        </div>

        <button type="submit" class="btn btn-primary mt-2">
          {% if editing %}Save{% else %}Submit Plan{% endif %}
        </button>
      </div>

      {# ---------- right column: thumbnail ---------- #}
      <div class="col-md-6">

        {% if editing and form.instance.image %}
          <div class="mt-md-2">          {# offset to line up with Name field #}
            <p class="fw-semibold mb-2">Current Image</p>
            <img src="{{ form.instance.image.url }}"
                 class="img-thumbnail"
                 style="max-width: 100%; height: auto;">
          </div>
        {% else %}
          <div class="mt-md-2 text-muted fst-italic">No image yet.</div>
        {% endif %}

      </div>

    </div>
  </form>
</div>
{% endblock %}
